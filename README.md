# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Типы данных

#### Интерфейс карточки

```
interface IItem {
id: string;
description: string;
image: string;
title: string;
category: string;
price: number;
}
```

#### Интерфейс заказа

```
interface IOrder {
payment: PaymentType;
address: string;
email: string;
phone: string;
items: string[];
total: number;
}
```

#### Выбор способа оплаты

```
type PaymentType = 'online' | 'cash';
```

#### Модель данных заказа

```
interface IOrderDataModel {
buyerFullData: IOrder;
payment: PaymentType;
address: string;
email: string;
phone: string;
items: string[];
total: number;
}
```

#### Данные апи сервера

```
export interface IApiData {
fetchProductCards(): Promise<{ items: IItem[] }>;
fetchProductCard(id: string): Promise<IItem>;
submitOrder(orderData: IOrder): Promise<object>;
}
```

#### Модель данных корзины

```
export interface IBasketDataModel {
addItem(item: Partial<IItem>): void;
removeItem(item: Partial<IItem>): void;
clear(): void;
total: number;
}
```

#### Представление корзины

```
export interface IBasketUI {
addItem(item: HTMLElement, itemId: string, sum: number): void;
removeItem(itemId: string): void;
clear(): void;
}
```

#### Интерфейс эмиттера

```
export interface IEventEmitter<T extends string> {
emit: (event: T, data?: unknown) => void;
}
```

#### Данные которые мы передаем в эмиттер

```
export interface IEventData {
element: HTMLElement;
data?: Partial<IItem>;
}
```

#### Архитектура приложения

Код приложения разделён на 3 слоя согласно парадигме MVP:

Слой данных Modal отвечает за хранение и изменение данных, слой представления Viev отвечает за отображение данных на странице, Слой свзи представления и данных осуществляется через событийно ориентированный подход, для него используется класс EventEmitter, слой реализован императивным кодом в файле -`index.ts`

## Классы

#### EventEmitter

events: { [key: string]: Array<(data?: unknown) => void> } — объект, хранящий обработчики событий.
Методы класса:

on(event: string, handler: (data?: unknown) => void): void — устанавливает обработчик для указанного события.
off(event: string, handler: (data?: unknown) => void): void — удаляет обработчик с указанного события.
emit(event: string, data?: unknown): void — инициирует событие.
onAll(handler: (event: string, data?: unknown) => void): void — устанавливает обработчик для всех возможных событий.
offAll(handler: (event: string, data?: unknown) => void): void — удаляет обработчики со всех событий.
trigger(event: string): (data?: unknown) => void — создает специальный коллбек, который при вызове активирует событие.
События:

Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.
Методы класса включают:

- `on` — устанавливает обработчик для указанного события.
- `off` — удаляет обработчик с указанного события.
- `emit` — инициирует события
- `onAll` — устанавливает обработчик для всех возможных событий.
- `offAll` — удаляет обработчики со всех событий.
- `trigger` — создает специальный коллбек, который при вызове активирует событие.

#### Api

Класс представляет собой универсальный инструмент для взаимодействия с веб-сервисами. Он инкапсулирует логику HTTP-запросов, обеспечивая удобный интерфейс для отправки и получения данных. 

- `baseUrl`: Строковая перекменная, хранящая базовый URL веб-сервиса.
- `options`: Объект настроек запроса, включающий заголовки, необходимые для корректной отправки данных.

Конструктор:

- Принимает `baseUrl` и необязательные `options`, инициализируя базовый URL и настройки запроса.

Методы класса:

- `handleResponse`: Защищенный метод, обрабатывающий ответ от сервера, преобразуя его в JSON и управляя ошибками.
- `get`: Метод для выполнения GET-запроса к указанному URI.
- `post`:- Принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется POST запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове

#### DataApi

Класс Наследуетcя от Api, содержит следующие методы:

- `getItems` - выполняет GET запрос, возвращает промис с массивом товаров
- `getItem` - выполняет GET запрос, возвращает промис с одним товаром
- `sendOrder` - выполняет POST запрос, возвращает промис с ответом сервера

#### Абстрактный класс View

Принадлежит слою представления. В конструкторе класса передаются DOM-элемент, EventEmitter и инициализируются события. Данные для отображения в классе, передаются в метод render()

обладет Методами:

- `toggleClass` - переключение класса
- `setDisable` - деактивация кнопок
- `setActive` - активация кнопок
- `setHidden` - скрытие элемента
- `setVisible` - отображение элемента
- `setText` - установка текста
- `setImage` - установка изображения
- `render` - Отображение данных.

#### ItemView

Класс Принадлежит слою представления, наследует логику от View и принимает данные товара в конструктор 

- `render` реализует разметку элемента и принимает данные для отображения карточки товара


#### ModalView

Класс относится к слою представления. Наследуется от View. Обеспечивает возможность открытия/закрытия модального окна. В конструктор принимает экземпляр EventEmitter. Имеет два основных метода:

- `openModal` - открывает модальное окно
- `closeModal` - закрывает модальное окно

#### BasketView

Класс Относится к слою представления. Наследует от View. Реализует разметку корзины покупателя. В конструктор принимает экземпляр EventEmitter
методы:

- `render` - переопределяет родительский метод возвращает разметку корзины и принимает данные корзины ( элементы карточек, сумму товаров и кнопку покупки)


#### FormView

Класс относится к слою представления. Наследует от View. Обеспечивает потомков следующими методами:

- `checkSubmitButtonState` - меняет состояние кнопки сабмита
- `checkIfValidated` - показывает ошибки, если пользователь вводит неверную информацию в форму
- `setupInputValidation` - инициализирует валидацию инпутов в формах
- `additionalRequirements` - метод проверки дополнительных условий для валидации форм, переопределяется в подклассах

#### OrderFormView

Класс относится к слою представления. Наследует от FormView, генерирует кастомные события формы. Переопределяет родительский метод `additionalRequirements`.

#### ContactsFormView

Класс относится к слою представления. Наследует от FormView. Генерирует кастомные события формы. Переопределяет родительский метод `additionalRequirements`.

#### SuccessfullOrderViev

Класс относится к слою представления. Наследует от View.

#### BasketModel

Класс относится к слою модели. Реализует хранение и изменение данных товаров в корзине покупателя. В конструктор принимает экземпляр `EventEmitter`. Массив с товарами будет храниться в классе ItemList

Имеет три метода и 2 геттера:

- `add` - добавляет товар в корзину
- `remove` - удаляет товар из корзины
- `clear` - очищает корзину
- `get items` - возвращает все товары, которые лежат в корзине
- `get total` - возвращает сумму заказа

#### OrderModel

Класс относится к слою модели. Реализует хранение и изменение данных о покупке. Реализует разметку сообщения об успешной покупке.

Владеет Геттером для возвращения полных данных заказа и Сэтерами для установки типа оплаты, адреса, элекронной почты, номера телефона, купленных товаров может устанавливать сумму заказа

#### Component

Класс является абстрактным базовым классом для создания компонентов пользовательского интерфейса. Он предоставляет общие методы для управления элементами DOM и взаимодействия с ними. 



- `Constructor`: Принимает HTMLElement, который служит контейнером для компонента. 

- `toggleClass`: Метод для переключения CSS класса у элемента. 

- `setText`: Устанавливает текстовое содержимое элемента. Принимает любой тип данных и преобразует его в строку.

- `setDisabled`: Изменяет атрибут disabled элемента в зависимости от переданного булевого значения state.

- `setHidden` и - `setVisible`: Методы для управления видимостью элемента, изменяя свойство display CSS.

- `setImage`: Устанавливает атрибуты src и alt для элемента HTMLImageElement, позволяя изменять изображение и его альтернативный текст.

- `render`: Возвращает корневой элемент DOM компонента. Может принимать необязательный параметр data для обновления состояния компонента перед рендерингом.

Этот класс предназначен для наследования и расширения его функциональности в конкретных компонентах пользовательского интерфейса. Он обеспечивает базовый набор инструментов для работы с DOM, что упрощает создание и управление компонентами.

#### ItemList

Класс отвечает за хранение и логику работы с данными карточки продукта. Класс наследуется от абстрактного класса Component 

Конструктор наследуется от абстрактного класса Component.

В полях класса хранятся следующие данные:

- `id: string` - уникальный номер товара
- `description`: string - описание товара
- `image`: string - изображение товара
- `title`: string - наименование товара
- `category`: string - категория, к которой относится товар
- `price`: number - стоимость товара

Методы:

- `getId()` - получение уникального номера
- `setTitle()` - установка наименования товара
- `setPrice()` - установка стоимости товара
- `setDescription()` - установка описания товара
- `setCategory()` - установка категории товара
- `setImage()` - установка изображения товара



